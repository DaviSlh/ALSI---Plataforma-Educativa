<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lección 1 - Cuestionario</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    /* Usamos las mismas variables CSS para modo oscuro que en index.html */
    /* Estas variables serán sobrescritas por las clases dark-mode / light-mode-manual */
    :root {
      --bg: #f9f6fb;
      --text: #4a3054;
      --card-bg: #ffffff;
      --primary: #c39bd3;
      --primary-dark: #af7ac5;
      --success: #27ae60;
      --error: #c0392b;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 2rem;
      max-width: 900px;
      margin: auto;
      transition: background 0.3s ease, color 0.3s ease;
    }

    h1, h2 {
      text-align: center;
      color: var(--primary-dark);
    }

    section {
      background: var(--card-bg);
      padding: 1.5rem 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      margin-bottom: 2rem;
      transition: background 0.3s ease;
    }

    .question p {
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .question img {
        max-width: 100%;
        height: auto;
        border-radius: 0.8rem;
        margin-bottom: 1rem;
        border: 2px solid #ebd6f4;
        display: block; /* Para centrar si es necesario y manejar mejor el flujo */
        margin-left: auto;
        margin-right: auto;
    }

    .options label {
      display: block;
      margin: 0.5rem 0;
      cursor: pointer;
    }
    .options label input[type="checkbox"],
    .options label input[type="radio"] {
      margin-right: 0.5rem;
    }

    button, .toggle-btn { /* Clase para el botón de modo oscuro */
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 0.5rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s ease;
      margin-top: 1rem;
    }

    button:hover, .toggle-btn:hover {
      background-color: var(--primary-dark);
    }

    .result-message { /* Clase para el resultado del quiz */
      margin-top: 1rem;
      font-weight: bold;
      padding: 0.8rem;
      border-radius: 0.5rem;
      text-align: center;
      color: white; /* Color de texto base para mensajes de resultado */
    }

    .result-message.passed {
        background-color: var(--success);
    }

    .result-message.failed {
        background-color: var(--error);
    }

    a {
      display: inline-block;
      margin-top: 2rem;
      text-decoration: none;
      background-color: var(--primary);
      color: white;
      padding: 0.7rem 1.4rem;
      border-radius: 0.6rem;
      font-weight: 600;
      transition: background-color 0.2s ease;
      margin-right: 1rem; /* Espacio entre los botones de navegación */
    }

    a:hover {
      background-color: var(--primary-dark);
    }

    .toggle-container {
      text-align: right;
      margin-bottom: 1.5rem;
    }

    /* Estilos para Modo Oscuro - Consistentes con index.html */
    body.dark-mode {
      background: #121212;
      color: #e0d8f0;
    }
    body.dark-mode h1, body.dark-mode h2 {
      color: #a87ce2; /* Un púrpura más claro para títulos */
    }
    body.dark-mode section {
      background: #2b2440; /* Fondo de tarjeta más oscuro */
      box-shadow: 0 6px 16px rgba(255, 255, 255, 0.1);
    }
    body.dark-mode .question p {
      color: #f3e8ff;
    }
    body.dark-mode .options label {
      color: #ddd;
    }
    body.dark-mode button, body.dark-mode .toggle-btn {
      background-color: #6c5498; /* Púrpura más oscuro para botones */
      color: #fff;
    }
    body.dark-mode button:hover, body.dark-mode .toggle-btn:hover {
      background-color: #a87ce2; /* Púrpura más claro al pasar el ratón */
    }
    body.dark-mode a {
      background-color: #6c5498;
      color: #fff;
    }
    body.dark-mode a:hover {
      background-color: #a87ce2;
    }
    body.dark-mode .result-message.passed {
      background-color: #2ecc71; /* Verde */
    }
    body.dark-mode .result-message.failed {
      background-color: #e74c3c; /* Rojo */
    }
    /* Para manejar prefers-color-scheme */
    @media (prefers-color-scheme: dark) {
      body:not(.light-mode-manual) {
        background: #121212;
        color: #e0d8f0;
      }
      body:not(.light-mode-manual) h1, body:not(.light-mode-manual) h2 {
        color: #a87ce2;
      }
      body:not(.light-mode-manual) section {
        background: #2b2440;
        box-shadow: 0 6px 16px rgba(255, 255, 255, 0.1);
      }
      body:not(.light-mode-manual) .question p {
        color: #f3e8ff;
      }
      body:not(.light-mode-manual) .options label {
        color: #ddd;
      }
      body:not(.light-mode-manual) button, body:not(.light-mode-manual) .toggle-btn {
        background-color: #6c5498;
        color: #fff;
      }
      body:not(.light-mode-manual) button:hover, body:not(.light-mode-manual) .toggle-btn:hover {
        background-color: #a87ce2;
      }
      body:not(.light-mode-manual) a {
        background-color: #6c5498;
        color: #fff;
      }
      body:not(.light-mode-manual) a:hover {
        background-color: #a87ce2;
      }
      body:not(.light-mode-manual) .result-message.passed {
        background-color: #2ecc71;
      }
      body:not(.light-mode-manual) .result-message.failed {
        background-color: #e74c3c;
      }
    }
  </style>
</head>
<body>

  <div class="toggle-container">
    <button id="toggle-dark-mode" class="toggle-btn">🌙 Modo Oscuro</button>
  </div>

  <h1>Lección 1</h1> <h2>Cuestionario de Repaso</h2>

  <section class="question">
    <p><strong>1. ¿Qué saludo representa la siguiente seña?</strong></p>
    <img src="TP1/hola.gif" alt="Seña de Hola" />
    <div class="options">
      <label><input type="radio" name="q1" value="A" /> Buenos días</label>
      <label><input type="radio" name="q1" value="B" /> Hola</label>
      <label><input type="radio" name="q1" value="C" /> Adiós</label>
    </div>
  </section>

  <section class="question">
    <p><strong>2. Observa la seña. ¿Qué significa este gesto en español?</strong></p>
    <img src="TP1/muchas-gracias.gif" alt="Seña de Muchas Gracias" />
    <div class="options">
      <label><input type="radio" name="q2" value="A" /> Por favor</label>
      <label><input type="radio" name="q2" value="B" /> De nada</label>
      <label><input type="radio" name="q2" value="C" /> Muchas Gracias</label>
    </div>
  </section>

  <section class="question">
    <p><strong>3. Esta seña indica:</strong></p>
    <img src="TP1/buenas-tardes.gif" alt="Seña de Buenas Tardes" />
    <div class="options">
      <label><input type="radio" name="q3" value="A" /> Buenos días</label>
      <label><input type="radio" name="q3" value="B" /> Buenas tardes</label>
      <label><input type="radio" name="q3" value="C" /> Buenas noches</label>
    </div>
  </section>

  <section class="question">
    <p><strong>4. ¿Qué expresión se asocia con el siguiente movimiento?</strong></p>
    <img src="TP1/como-estas.gif" alt="Seña de ¿Cómo estás?" />
    <div class="options">
      <label><input type="radio" name="q4" value="A" /> ¿Qué tal?</label>
      <label><input type="radio" name="q4" value="B" /> ¿Quién eres?</label>
      <label><input type="radio" name="q4" value="C" /> ¿Cómo estás?</label>
    </div>
  </section>

  <section class="question">
    <p><strong>5. Identifica la seña para "Bienvenido(a)":</strong></p>
    <img src="TP1/bienvenido.gif" alt="Seña de Bienvenido" />
    <div class="options">
      <label><input type="radio" name="q5" value="A" /> Mucho gusto</label>
      <label><input type="radio" name="q5" value="B" /> Adiós</label>
      <label><input type="radio" name="q5" value="C" /> Bienvenido(a)</label>
    </div>
  </section>

  <section class="question">
    <p><strong>6. Observa el gesto. ¿A qué se refiere?</strong></p>
    <img src="TP1/adios.gif" alt="Seña de Adiós" />
    <div class="options">
      <label><input type="radio" name="q6" value="A" /> Hasta luego</label>
      <label><input type="radio" name="q6" value="B" /> Adiós</label>
      <label><input type="radio" name="q6" value="C" /> Nos vemos</label>
    </div>
  </section>

  <section class="question">
    <p><strong>7. ¿Qué seña se muestra en la imagen?</strong></p>
    <img src="TP1/de-donde-eres.gif" alt="Seña de ¿De dónde eres?" />
    <div class="options">
      <label><input type="radio" name="q7" value="A" /> Mi nombre es...</label>
      <label><input type="radio" name="q7" value="B" /> ¿De dónde eres?</label>
      <label><input type="radio" name="q7" value="C" /> ¿Cuántos años tienes?</label>
    </div>
  </section>

  <section class="question">
    <p><strong>8. ¿Cuál es el propósito principal de la Lección 1, según su título y descripción inicial?</strong></p>
    <div class="options">
      <label><input type="radio" name="q8" value="A" /> Aprender el alfabeto en lengua de señas.</label>
      <label><input type="radio" name="q8" value="B" /> Explorar y aprender saludos básicos en Lengua de Señas.</label>
      <label><input type="radio" name="q8" value="C" /> Conocer la historia de la Lengua de Señas.</label>
    </div>
  </section>

  <section class="question">
    <p><strong>9. En la seña de "Buenos días", ¿qué simula el segundo movimiento?</strong></p>
    <div class="options">
      <label><input type="radio" name="q9" value="A" /> La salida del sol.</label>
      <label><input type="radio" name="q9" value="B" /> El atardecer.</label>
      <label><input type="radio" name="q9" value="C" /> Una nube.</label>
    </div>
  </section>

  <section class="question">
    <p><strong>10. ¿Cuál de las siguientes descripciones corresponde a la seña de "Mucho gusto"?</strong></p>
    <div class="options">
      <label><input type="radio" name="q10" value="A" /> Extender la mano desde la frente hacia afuera.</label>
      <label><input type="radio" name="q10" value="B" /> Gesto de pregunta con cejas levantadas.</label>
      <label><input type="radio" name="q10" value="C" /> Palmas juntas frente al pecho con sonrisa.</label>
    </div>
  </section>

  <button onclick="verificar()">Enviar</button>
  <div class="result-message" id="resultado"></div>

  <a href="index.html">Volver al índice</a>
  <a href="leccion2.html">Siguiente →</a>
  <script>
    // --- LÓGICA DE MODO OSCURO (CONSISTENTE CON LAS OTRAS PÁGINAS) ---
    const toggleDarkModeBtn = document.getElementById("toggle-dark-mode");
    const body = document.body;
    const localStorageDarkModeKey = 'darkMode'; // Clave unificada

    function applyMode(isDarkMode) {
      if (isDarkMode) {
        body.classList.add("dark-mode");
        body.classList.remove("light-mode-manual");
        toggleDarkModeBtn.textContent = "☀️ Modo Claro"; // Texto uniforme
      } else {
        body.classList.remove("dark-mode");
        body.classList.add("light-mode-manual");
        toggleDarkModeBtn.textContent = "🌙 Modo Oscuro"; // Texto uniforme
      }
    }

    function toggleDarkMode() {
      const currentMode = localStorage.getItem(localStorageDarkModeKey);
      let newMode;

      if (currentMode === 'enabled' || (currentMode === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        newMode = 'disabled';
      } else {
        newMode = 'enabled';
      }
      localStorage.setItem(localStorageDarkModeKey, newMode);
      applyMode(newMode === 'enabled');
    }

    document.addEventListener('DOMContentLoaded', () => {
      const savedMode = localStorage.getItem(localStorageDarkModeKey);
      if (savedMode) {
        applyMode(savedMode === 'enabled');
      } else {
        // Si no hay preferencia guardada, aplicar según la preferencia del sistema
        applyMode(window.matchMedia('(prefers-color-scheme: dark)').matches);
      }
      // Asignar el evento al botón de modo oscuro al cargar el DOM
      if (toggleDarkModeBtn) {
          toggleDarkModeBtn.addEventListener('click', toggleDarkMode);
      }
    });

    // Escuchar cambios en la preferencia del sistema si no hay preferencia del usuario
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
      if (!localStorage.getItem(localStorageDarkModeKey)) { // Solo si el usuario no ha forzado un modo
        applyMode(event.matches);
      }
    });


    // --- LÓGICA DEL CUESTIONARIO Y CONEXIÓN CON EL PROGRESO GLOBAL ---

    // La función saveProgress guarda el estado de la lección
    function saveProgress(lessonId, status) {
        localStorage.setItem(`lessonProgress_${lessonId}`, status);
    }

    // La función submitQuiz es la que se usa para interactuar con el sistema de progreso del index.html
    function submitQuiz(lessonId, scoreObtained) {
        // En este archivo de quiz, simplemente llamamos al padre (index.html) para que actualice el progreso
        // ya que la lógica de desbloqueo y UI está centralizada en index.html.
        // Esto asume que 'index.html' es el 'parent' en el contexto de un iframe o que se usa localStorage.
        // Como estamos usando localStorage, no necesitamos `parent.submitQuiz`.
        // Guardamos directamente aquí y el index.html se encargará al recargar.
        const MIN_SCORE_FOR_THIS_QUIZ = 70; // Traerlo del data-min-score de la lección en index si quieres que sea dinámico, pero para este archivo específico lo ponemos fijo.

        if (scoreObtained >= MIN_SCORE_FOR_THIS_QUIZ) {
            alert(`¡Cuestionario aprobado con ${scoreObtained.toFixed(0)}%! Volviendo al índice para continuar.`);
            saveProgress(lessonId, 'completed');
        } else {
            alert(`Cuestionario reprobado con ${scoreObtained.toFixed(0)}%. Necesitas ${MIN_SCORE_FOR_THIS_QUIZ}%. Puedes volver a intentarlo.`);
            saveProgress(lessonId, 'unlocked'); // Si reprueba, la lección sigue desbloqueada para reintentar
        }
        // Después de guardar el progreso, redirigimos al index.html
        window.location.href = 'index.html';
    }


    function verificar() {
      const LESSON_ID = 'lesson1'; // ID de la lección para guardar el progreso
      const MIN_SCORE_FOR_THIS_QUIZ = 70; // Puntaje mínimo para aprobar este cuestionario

      let aciertos = 0;
      const totalPreguntas = 10;

      // Respuestas correctas (asegúrate de que estas coincidan con tus preguntas y opciones)
      const answers = {
          q1: "B", // Hola
          q2: "C", // Muchas Gracias
          q3: "B", // Buenas tardes
          q4: "C", // ¿Cómo estás?
          q5: "C", // Bienvenido(a)
          q6: "B", // Adiós
          q7: "B", // ¿De dónde eres?
          q8: "B", // Explorar y aprender saludos básicos en Lengua de Señas.
          q9: "A", // La salida del sol.
          q10: "C" // Palmas juntas frente al pecho con sonrisa.
      };

      for (let i = 1; i <= totalPreguntas; i++) {
          const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
          if (selectedOption && selectedOption.value === answers[`q${i}`]) {
              aciertos++;
          }
      }

      const score = (aciertos / totalPreguntas) * 100;
      const resultadoDiv = document.getElementById("resultado");

      resultadoDiv.textContent = ''; // Limpiar mensaje anterior
      resultadoDiv.classList.remove('passed', 'failed'); // Limpiar clases anteriores

      if (score >= MIN_SCORE_FOR_THIS_QUIZ) {
        resultadoDiv.textContent = `✅ ¡Felicidades! Has aprobado el cuestionario con un ${score.toFixed(0)}%.`;
        resultadoDiv.classList.add('passed');
        // Llama a submitQuiz para guardar el progreso y redirigir
        submitQuiz(LESSON_ID, score);
      } else {
        resultadoDiv.innerHTML = `❌ Necesitas un ${MIN_SCORE_FOR_THIS_QUIZ}% para aprobar. Tu puntuación: ${score.toFixed(0)}%.<br>¡Sigue practicando!`;
        resultadoDiv.classList.add('failed');
        // Llama a submitQuiz para guardar el progreso y redirigir
        submitQuiz(LESSON_ID, score);
      }
    }
  </script>

</body>
</html>
