<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lecci√≥n 1 - Cuestionario</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    /* Usamos las mismas variables CSS para modo oscuro que en index.html */
    /* Estas variables ser√°n sobrescritas por las clases dark-mode / light-mode-manual */
    :root {
      --bg: #f9f6fb;
      --text: #4a3054;
      --card-bg: #ffffff;
      --primary: #c39bd3;
      --primary-dark: #af7ac5;
      --success: #27ae60;
      --error: #c0392b;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      padding: 2rem;
      max-width: 900px;
      margin: auto;
      transition: background 0.3s ease, color 0.3s ease;
    }

    h1, h2 {
      text-align: center;
      color: var(--primary-dark);
    }

    section {
      background: var(--card-bg);
      padding: 1.5rem 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      margin-bottom: 2rem;
      transition: background 0.3s ease;
    }

    .question p {
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .options label {
      display: block;
      margin: 0.5rem 0;
      cursor: pointer;
    }
    .options label input[type="checkbox"],
    .options label input[type="radio"] {
      margin-right: 0.5rem;
    }

    button, .toggle-btn { /* Clase para el bot√≥n de modo oscuro */
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 0.5rem;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.2s ease;
      margin-top: 1rem;
    }

    button:hover, .toggle-btn:hover {
      background-color: var(--primary-dark);
    }

    .result-message { /* Clase para el resultado del quiz */
      margin-top: 1rem;
      font-weight: bold;
      padding: 0.8rem;
      border-radius: 0.5rem;
      text-align: center;
      color: white; /* Color de texto base para mensajes de resultado */
    }

    .result-message.passed {
        background-color: var(--success);
    }

    .result-message.failed {
        background-color: var(--error);
    }

    a {
      display: inline-block;
      margin-top: 2rem;
      text-decoration: none;
      background-color: var(--primary);
      color: white;
      padding: 0.7rem 1.4rem;
      border-radius: 0.6rem;
      font-weight: 600;
      transition: background-color 0.2s ease;
      margin-right: 1rem; /* Espacio entre los botones de navegaci√≥n */
    }

    a:hover {
      background-color: var(--primary-dark);
    }

    .toggle-container {
      text-align: right;
      margin-bottom: 1.5rem;
    }

    /* Estilos para Modo Oscuro - Consistentes con index.html */
    body.dark-mode {
      background: #121212;
      color: #e0d8f0;
    }
    body.dark-mode h1, body.dark-mode h2 {
      color: #a87ce2; /* Un p√∫rpura m√°s claro para t√≠tulos */
    }
    body.dark-mode section {
      background: #2b2440; /* Fondo de tarjeta m√°s oscuro */
      box-shadow: 0 6px 16px rgba(255, 255, 255, 0.1);
    }
    body.dark-mode .question p {
      color: #f3e8ff;
    }
    body.dark-mode .options label {
      color: #ddd;
    }
    body.dark-mode button, body.dark-mode .toggle-btn {
      background-color: #6c5498; /* P√∫rpura m√°s oscuro para botones */
      color: #fff;
    }
    body.dark-mode button:hover, body.dark-mode .toggle-btn:hover {
      background-color: #a87ce2; /* P√∫rpura m√°s claro al pasar el rat√≥n */
    }
    body.dark-mode a {
      background-color: #6c5498;
      color: #fff;
    }
    body.dark-mode a:hover {
      background-color: #a87ce2;
    }
    body.dark-mode .result-message.passed {
      background-color: #2ecc71; /* Verde */
    }
    body.dark-mode .result-message.failed {
      background-color: #e74c3c; /* Rojo */
    }
    /* Para manejar prefers-color-scheme */
    @media (prefers-color-scheme: dark) {
      body:not(.light-mode-manual) {
        background: #121212;
        color: #e0d8f0;
      }
      body:not(.light-mode-manual) h1, body:not(.light-mode-manual) h2 {
        color: #a87ce2;
      }
      body:not(.light-mode-manual) section {
        background: #2b2440;
        box-shadow: 0 6px 16px rgba(255, 255, 255, 0.1);
      }
      body:not(.light-mode-manual) .question p {
        color: #f3e8ff;
      }
      body:not(.light-mode-manual) .options label {
        color: #ddd;
      }
      body:not(.light-mode-manual) button, body:not(.light-mode-manual) .toggle-btn {
        background-color: #6c5498;
        color: #fff;
      }
      body:not(.light-mode-manual) button:hover, body:not(.light-mode-manual) .toggle-btn:hover {
        background-color: #a87ce2;
      }
      body:not(.light-mode-manual) a {
        background-color: #6c5498;
        color: #fff;
      }
      body:not(.light-mode-manual) a:hover {
        background-color: #a87ce2;
      }
      body:not(.light-mode-manual) .result-message.passed {
        background-color: #2ecc71;
      }
      body:not(.light-mode-manual) .result-message.failed {
        background-color: #e74c3c;
      }
    }
  </style>
</head>
<body>

  <div class="toggle-container">
    <button id="toggle-dark-mode" class="toggle-btn">üåì Modo Oscuro</button>
  </div>

  <h1>Lecci√≥n 1</h1> <h2>Cuestionario de Repaso</h2>

  <section class="question">
    <p><strong>1. ¬øCu√°les de los siguientes son saludos apropiados en espa√±ol?</strong></p>
    <div class="options">
      <label><input type="checkbox" name="q1" value="Hola" /> Hola</label>
      <label><input type="checkbox" name="q1" value="Adi√≥s" /> Adi√≥s</label>
      <label><input type="checkbox" name="q1" value="Gracias" /> Gracias</label>
      <label><input type="checkbox" name="q1" value="Buenas tardes" /> Buenas tardes</label>
      <label><input type="checkbox" name="q1" value="Mesa" /> Mesa</label>
    </div>
  </section>

  <section class="question">
    <p><strong>2. ¬øC√≥mo se hace la se√±a de "Buenos d√≠as"?</strong></p>
    <div class="options">
      <label><input type="radio" name="q2" value="A" /> Mano desde el pecho hacia afuera como si empujaras algo</label>
      <label><input type="radio" name="q2" value="B" /> Mano desde la boca hacia afuera y luego gesto de sol saliendo</label>
      <label><input type="radio" name="q2" value="C" /> Palmas juntas frente al pecho</label>
    </div>
  </section>

  <section class="question">
    <p><strong>3. ¬øCu√°l de estos gestos representa "Cu√≠date"?</strong></p>
    <div class="options">
      <label><input type="radio" name="q3" value="A" /> Dos dedos desde los ojos hacia adelante</label>
      <label><input type="radio" name="q3" value="B" /> Mano en forma de garra sobre el coraz√≥n y luego hacia la persona</label>
      <label><input type="radio" name="q3" value="C" /> Mano abierta movi√©ndose como saludo</label>
    </div>
  </section>

  <section class="question">
    <p><strong>4. ¬øQu√© se√±a implica un movimiento circular con las manos hacia el pecho?</strong></p>
    <div class="options">
      <label><input type="radio" name="q4" value="A" /> Mucho gusto</label>
      <label><input type="radio" name="q4" value="B" /> Bienvenido(a)</label>
      <label><input type="radio" name="q4" value="C" /> Hasta ma√±ana</label>
    </div>
  </section>

  <button onclick="verificar()">Enviar</button>
  <div class="result-message" id="resultado"></div>

  <a href="index.html">Volver al √≠ndice</a>
  <a href="lesson2.html">Siguiente ‚Üí</a> <script>
    // --- L√ìGICA DE MODO OSCURO (CONSISTENTE CON LAS OTRAS P√ÅGINAS) ---
    const toggleDarkModeBtn = document.getElementById("toggle-dark-mode");
    const body = document.body;

    function applyMode(isDarkMode) {
      if (isDarkMode) {
        body.classList.add("dark-mode");
        body.classList.remove("light-mode-manual");
        toggleDarkModeBtn.textContent = "‚òÄÔ∏è Modo Claro";
      } else {
        body.classList.remove("dark-mode");
        body.classList.add("light-mode-manual");
        toggleDarkModeBtn.textContent = "üåô Modo Oscuro";
      }
    }

    function toggleDarkMode() {
      const currentMode = localStorage.getItem("darkMode");
      let newMode;

      if (currentMode === 'enabled' || (currentMode === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        newMode = 'disabled';
      } else {
        newMode = 'enabled';
      }
      localStorage.setItem("darkMode", newMode);
      applyMode(newMode === 'enabled');
    }

    document.addEventListener('DOMContentLoaded', () => {
      const savedMode = localStorage.getItem("darkMode");
      if (savedMode) {
        applyMode(savedMode === 'enabled');
      } else {
        applyMode(window.matchMedia('(prefers-color-scheme: dark)').matches);
      }
    });

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
      if (!localStorage.getItem("darkMode")) {
        applyMode(event.matches);
      }
    });

    // --- L√ìGICA DEL CUESTIONARIO Y CONEXI√ìN CON EL PROGRESO GLOBAL ---

    // Importa la funci√≥n submitQuiz del index.html.
    // Para que esto funcione, este script debe ser cargado DESPU√âS del script principal en index.html,
    // o el script principal de index.html debe ser un archivo externo (ej. script.js)
    // que se vincule a todas las p√°ginas.
    // Por ahora, asumimos que submitQuiz est√° disponible globalmente,
    // o que este script se copiar√° dentro de index.html si es un quiz "en l√≠nea".
    // SI Prueba.html es un archivo SEPARADO, NECESITAS CARGAR EL SCRIPT COMPLETO DEL INDEX.HTML AQU√ç TAMBI√âN.
    // La forma m√°s robusta es poner todo el JS de control de lecciones en un archivo externo como 'main.js'
    // y vincular 'main.js' tanto en index.html como en Prueba.html.

    // === INICIO DEL C√ìDIGO NECESARIO DEL SCRIPT PRINCIPAL DEL INDEX.HTML ===
    // (Esto es un ejemplo, lo ideal es que lo tengas en un archivo JS externo y lo cargues en todas las p√°ginas)
    const MIN_PASS_SCORE = 70; // Debe ser consistente con el valor en index.html

    function saveProgress(lessonId, status) {
        localStorage.setItem(`lessonProgress_${lessonId}`, status);
        // En un entorno de m√∫ltiples p√°ginas, no podemos actualizar la barra de progreso
        // ni las tarjetas del index directamente desde aqu√≠.
        // Esto se har√° cuando el usuario vuelva al index.html.
    }

    // Adaptamos la funci√≥n `submitQuiz` para que este archivo pueda llamarla.
    // Esta es una versi√≥n simplificada, la versi√≥n completa est√° en index.html
    // y es la que actualiza el UI de las tarjetas.
    function submitQuiz(lessonId, scoreObtained) {
        const lessonElement = document.getElementById(lessonId); // Este elemento NO existir√° en Prueba.html
                                                                 // as√≠ que el mensaje de alerta es importante.
        let minScoreFromIndex = MIN_PASS_SCORE; // Usamos el valor por defecto

        // Intentar leer el minScore de localStorage si se guard√≥
        // (Ser√≠a ideal si el index.html guardara la configuraci√≥n de las lecciones en localStorage)
        // Por ahora, nos basamos en el MIN_PASS_SCORE global.

        if (scoreObtained >= minScoreFromIndex) {
            alert(`¬°Cuestionario aprobado con ${scoreObtained}%! La siguiente lecci√≥n se desbloquear√°.`);
            saveProgress(lessonId, 'completed');
        } else {
            alert(`Cuestionario reprobado con ${scoreObtained}%. Necesitas ${minScoreFromIndex}%.`);
            saveProgress(lessonId, 'unlocked'); // La lecci√≥n sigue desbloqueada para reintentar
        }

        // Despu√©s de enviar el quiz, podr√≠as redirigir al index o a la siguiente lecci√≥n
        // window.location.href = 'index.html'; // O redirigir a la siguiente lecci√≥n directamente si la aprueba
    }
    // === FIN DEL C√ìDIGO NECESARIO DEL SCRIPT PRINCIPAL ===

    function verificar() {
      // ID de la lecci√≥n a la que pertenece este cuestionario (corresponde a id="lesson1" en index.html)
      const LESSON_ID = 'lesson1';
      const MIN_SCORE_FOR_THIS_QUIZ = 70; // Aseg√∫rate que este sea el mismo que en data-min-score de index.html

      // Pregunta 1 (checkbox)
      const correctas1 = ["Hola", "Buenas tardes"];
      const seleccionadas1 = Array.from(document.querySelectorAll('input[name="q1"]:checked')).map(cb => cb.value);
      const p1_correcta = correctas1.every(r => seleccionadas1.includes(r)) && seleccionadas1.every(r => correctas1.includes(r));

      // Pregunta 2 (radio)
      const respuesta2 = document.querySelector('input[name="q2"]:checked');
      const p2_correcta = respuesta2 && respuesta2.value === "B";

      // Pregunta 3 (radio)
      const respuesta3 = document.querySelector('input[name="q3"]:checked');
      const p3_correcta = respuesta3 && respuesta3.value === "B"; // La respuesta correcta es 'B' seg√∫n tu lecci√≥n

      // Pregunta 4 (radio)
      const respuesta4 = document.querySelector('input[name="q4"]:checked');
      const p4_correcta = respuesta4 && respuesta4.value === "B";

      let aciertos = 0;
      if (p1_correcta) aciertos++;
      if (p2_correcta) aciertos++;
      if (p3_correcta) aciertos++;
      if (p4_correcta) aciertos++;

      const total = 4;
      const score = (aciertos / total) * 100;
      const resultadoDiv = document.getElementById("resultado");

      resultadoDiv.textContent = ''; // Limpiar mensajes anteriores
      resultadoDiv.classList.remove('passed', 'failed'); // Limpiar clases anteriores

      if (score >= MIN_SCORE_FOR_THIS_QUIZ) {
        resultadoDiv.textContent = `‚úÖ ¬°Felicidades! Has aprobado el cuestionario con un ${score.toFixed(0)}%.`;
        resultadoDiv.classList.add('passed');
        submitQuiz(LESSON_ID, score); // Llama a la funci√≥n global para registrar el progreso
      } else {
        let mensajesError = [];
        if (!p1_correcta) mensajesError.push("Pregunta 1: respuestas incorrectas.");
        if (!p2_correcta) mensajesError.push("Pregunta 2: respuesta incorrecta.");
        if (!p3_correcta) mensajesError.push("Pregunta 3: respuesta incorrecta.");
        if (!p4_correcta) mensajesError.push("Pregunta 4: respuesta incorrecta.");

        resultadoDiv.innerHTML = `‚ùå Necesitas un ${MIN_SCORE_FOR_THIS_QUIZ}% para aprobar. Tu puntuaci√≥n: ${score.toFixed(0)}%.<br>Errores: ${mensajesError.join("<br>")}`;
        resultadoDiv.classList.add('failed');
        submitQuiz(LESSON_ID, score); // Llama a la funci√≥n global para registrar el progreso (como no completado)
      }
    }
  </script>

</body>
</html>
